name: 40-Reusable-Docker-Deploy

on:
  workflow_call:

jobs:
  deploy:
    runs-on: [self-hosted, Windows, X64]
    defaults:
      run:
        shell: powershell

    steps:
      - name: GHCR Login
        run: echo "${{ secrets.GHCR_PAT }}" | docker login ghcr.io -u "${{ secrets.GHCR_USERNAME }}" --password-stdin

      - name: Switch directory
        run: Set-Location "C:\\docker\\berlinclock"

      - name: Pull images
        run: docker compose pull

      - name: Restart
        run: docker compose up -d
